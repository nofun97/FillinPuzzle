% sample puzzle [['_','_','_','_'],['_','_','_',#],['_','_','_','_']]
% sample words [[b,o,a,t],[a,r,t],[n,e,e,d],[b,a,n],[o,r,e],[a,t,e]]
solve_puzzle([['_','_','_','_'],['_','_','_','#'],['_','_','_','_']], [[b,o,a,t],[a,r,t],[n,e,e,d],[b,a,n],[o,r,e],[a,t,e]], X).
% empty puzzle X = [[1, 3, [[1, 0]]], [2, 4, [[0, 0], [2, 0]]]]
% transposed empty puzzle [[2,1,[[3,0],[3,2]]],[3,3,[[0,0],[1,0],[2,0]]]]
% processed word [[2,4,[[b,o,a,t],[n,e,e,d]]],[4,3,[[a,r,t],[a,t,e],[b,a,n],[o,r,e]]]]
process_puzzle([['_','_','_','_'],['_','_','_',#],['_','_','_','_']], [[1, 3, [[1, 0]]], [2, 4, [[0, 0], [2, 0]]]], [[2,1,[[3,0],[3,2]]],[3,3,[[0,0],[1,0],[2,0]]]], [[2,4,[[b,o,a,t],[n,e,e,d]]],[4,3,[[a,r,t],[a,t,e],[b,a,n],[o,r,e]]]], X).


%puzzle 6
[['_','_','_','_','_',#,'_','_','_'],
['_','_','_','_',#,'_','_','_','_'],
['_','_',#,#,#,'_','_','_','_'],
[#,#,'_','_','_','_','_','_',#],
['_','_','_','_','_','_','_','_','_'],
[#,'_','_','_','_','_','_',#,#],
['_','_','_','_',#,#,#,'_','_'],
['_','_','_','_',#,'_','_','_','_'],
['_','_','_',#,'_','_','_','_','_']]

%words6
[['A','L','U'],
['D','O','F','O','F','U'],
['G','A'],
['G','S','K','R','C'],
['G','T','F'],
['G','T','F','F','L'],
['H','O','T','L'],
['H','V'],['K','E','G'],
['L','F','O'],
['L','R','Z'],
['L','T','T','F'],
['L','V','O','F','U'],
['N','T','T'],
['O','D'],
['O','G'],
['O','O'],
['Q','E','D','T'],
['Q','T'],
['Q','Z','Z','T','F','Z','O','C','T'],
['R','G','U','L'],
['W','G','K','T'],
['Z','D','T','G','G'],
['Z','G','H'],
['Z','G','L','L','T','R'],
['Z','G','N'],
['Z','K','O','Q','S'],
['Z','O','G','T','O','U'],
['Z','O','S','T'],
['Z','Q','O'],
['Z','W','L','Z','F'],
['Z','Z','O','T','U','H']]

%emptypuzzle6
[[2,2,[[2,0],[6,7]]],[2,3,[[0,6],[8,0]]],[6,4,[[1,0],[1,5],[2,5],[6,0],[7,0],[7,5]]],[2,5,[[0,0],[8,4]]],[2,6,[[3,2],[5,1]]],[1,9,[[4,0]]]]
%transposedpuzzl6
[[4,1,[[0,4],[4,0],[4,8],[8,4]]],[4,2,[[2,0],[3,0],[5,7],[6,7]]],[7,3,[[0,0],[0,6],[1,0],[4,3],[7,6],[8,0],[8,6]]],[4,5,[[1,4],[3,3],[5,1],[7,0]]],[2,6,[[2,3],[6,0]]]]
%processword6
[[1,9,[['Q','Z','Z','T','F','Z','O','C','T']]],[4,6,[['D','O','F','O','F','U'],['Z','G','L','L','T','R'],['Z','O','G','T','O','U'],['Z','Z','O','T','U','H']]],[6,2,[['G','A'],['H','V'],['O','D'],['O','G'],['O','O'],['Q','T']]],[6,4,[['H','O','T','L'],['L','T','T','F'],['Q','E','D','T'],['R','G','U','L'],['W','G','K','T'],['Z','O','S','T']]],[6,5,[['G','S','K','R','C'],['G','T','F','F','L'],['L','V','O','F','U'],['Z','D','T','G','G'],['Z','K','O','Q','S'],['Z','W','L','Z','F']]],[9,3,[['A','L','U'],['G','T','F'],['K','E','G'],['L','F','O'],['L','R','Z'],['N','T','T'],['Z','G','H'],['Z','G','N'],['Z','Q','O']]]]
%query
process_puzzle([['_','_','_','_','_',#,'_','_','_'],
    ['_','_','_','_',#,'_','_','_','_'],
    ['_','_',#,#,#,'_','_','_','_'],
    [#,#,'_','_','_','_','_','_',#],
    ['_','_','_','_','_','_','_','_','_'],
    [#,'_','_','_','_','_','_',#,#],
    ['_','_','_','_',#,#,#,'_','_'],
    ['_','_','_','_',#,'_','_','_','_'],
    ['_','_','_',#,'_','_','_','_','_']], 
[[2,2,[[2,0],[6,7]]],[2,3,[[0,6],[8,0]]],[6,4,[[1,0],[1,5],[2,5],[6,0],[7,0],[7,5]]],[2,5,[[0,0],[8,4]]],[2,6,[[3,2],[5,1]]],[1,9,[[4,0]]]],
[[4,1,[[0,4],[4,0],[4,8],[8,4]]],[4,2,[[2,0],[3,0],[5,7],[6,7]]],[7,3,[[0,0],[0,6],[1,0],[4,3],[7,6],[8,0],[8,6]]],[4,5,[[1,4],[3,3],[5,1],[7,0]]],[2,6,[[2,3],[6,0]]]],
[[1,9,[['Q','Z','Z','T','F','Z','O','C','T']]],[4,6,[['D','O','F','O','F','U'],['Z','G','L','L','T','R'],['Z','O','G','T','O','U'],['Z','Z','O','T','U','H']]],[6,2,[['G','A'],['H','V'],['O','D'],['O','G'],['O','O'],['Q','T']]],[6,4,[['H','O','T','L'],['L','T','T','F'],['Q','E','D','T'],['R','G','U','L'],['W','G','K','T'],['Z','O','S','T']]],[6,5,[['G','S','K','R','C'],['G','T','F','F','L'],['L','V','O','F','U'],['Z','D','T','G','G'],['Z','K','O','Q','S'],['Z','W','L','Z','F']]],[9,3,[['A','L','U'],['G','T','F'],['K','E','G'],['L','F','O'],['L','R','Z'],['N','T','T'],['Z','G','H'],['Z','G','N'],['Z','Q','O']]]],
X), print(X).


% filled puzzle6
%[['Z','K','O','Q','S',#,'Z','G','_'],['Q','E','D','T',#,'Z','O','S','T'],['G','A',#,#,#,'W','G','K','T'],[#,#,'Z','G','L','L','T','R',#],['Q','Z','Z','T','F','Z','O','C','T'],[#,'D','O','F','O','F','U',#,#],['L','T','T','F',#,#,#,'O','G'],['R','G','U','L',#,'H','O','T','L'],['_','G','H',#,'L','V','O','F','U']]
% remaining words
%[[9,3,[['A','L','U'],['G','T','F'],['K','E','G'],['L','F','O'],['L','R','Z'],['N','T','T'],['Z','G','H'],['Z','G','N'],['Z','Q','O']]]]
% locations [2,3,[[0,6],[8,0]]]
% transposed [7,3,[[0,0],[0,6],[1,0],[4,3],[7,6],[8,0],[8,6]]]

process_puzzle([['Z','K','O','Q','S',#,'Z','G','_'],['Q','E','D','T',#,'Z','O','S','T'],['G','A',#,#,#,'W','G','K','T'],[#,#,'Z','G','L','L','T','R',#],['Q','Z','Z','T','F','Z','O','C','T'],[#,'D','O','F','O','F','U',#,#],['L','T','T','F',#,#,#,'O','G'],['R','G','U','L',#,'H','O','T','L'],['_','G','H',#,'L','V','O','F','U']],
    [[2,3,[[0,6],[8,0]]]],
[[7,3,[[0,0],[0,6],[1,0],[4,3],[7,6],[8,0],[8,6]]]],
[[9,3,[['A','L','U'],['G','T','F'],['K','E','G'],['L','F','O'],['L','R','Z'],['N','T','T'],['Z','G','H'],['Z','G','N'],['Z','Q','O']]]],
X), print(X).
filling_fixed_words([['Z','K','O','Q','S',#,'Z','G','_'],['Q','E','D','T',#,'Z','O','S','T'],['G','A',#,#,#,'W','G','K','T'],[#,#,'Z','G','L','L','T','R',#],['Q','Z','Z','T','F','Z','O','C','T'],[#,'D','O','F','O','F','U',#,#],['L','T','T','F',#,#,#,'O','G'],['R','G','U','L',#,'H','O','T','L'],['_','G','H',#,'L','V','O','F','U']],[[0,6],[8,0]],
[[0,0],[0,6],[1,0],[4,3],[7,6],[8,0],[8,6]],[['A','L','U'],['G','T','F'],['K','E','G'],['L','F','O'],['L','R','Z'],['N','T','T'],['Z','G','H'],['Z','G','N'],['Z','Q','O']],X,Y).

filling_fixed_words([['Z','K','O','Q','S',#,'Z','G','_'],['Q','E','D','T',#,'Z','O','S','T'],['G','A',#,#,#,'W','G','K','T'],[#,#,'Z','G','L','L','T','R',#],['Q','Z','Z','T','F','Z','O','C','T'],[#,'D','O','F','O','F','U',#,#],['L','T','T','F',#,#,#,'O','G'],['R','G','U','L',#,'H','O','T','L'],['_','G','H',#,'L','V','O','F','U']],[[2,3,[[0,6],[8,0]]]],[[7,3,[[0,0],[0,6],[1,0],[4,3],[7,6],[8,0],[8,6]]]],[[9,3,[['A','L','U'],['G','T','F'],['K','E','G'],['L','F','O'],['L','R','Z'],['N','T','T'],['Z','G','H'],['Z','G','N'],['Z','Q','O']]]],_,_,_,X), print_puzzle("./test2", X).
time(main("./samples/puzzle1", "./samples/words1", "./test")).
placing_fixed_words([['Z','K','O','Q','S',#,'Z','G','_'],['Q','E','D','T',#,'Z','O','S','T'],['G','A',#,#,#,'W','G','K','T'],[#,#,'Z','G','L','L','T','R',#],['Q','Z','Z','T','F','Z','O','C','T'],[#,'D','O','F','O','F','U',#,#],['L','T','T','F',#,#,#,'O','G'],['R','G','U','L',#,'H','O','T','L'],['_','G','H',#,'L','V','O','F','U']], [[0,6],[8,0]],_,[['A','L','U'],['G','T','F'],['K','E','G'],['L','F','O'],['L','R','Z'],['N','T','T'],['Z','G','H'],['Z','G','N'],['Z','Q','O']], X, Y), print_puzzle("./test3", Y).
read_file("./samples/puzzle1",X), process_empty_puzzle(X, Y), print(Y).
ensure_loaded(library(clpfd)), read_file("./samples/puzzle1",A), clpfd:transpose(A,X), process_empty_puzzle(X, Y), print(Y).
read_file("./samples/words1",A), process_word(A, B), print(B).
%puzzle1
% [['_','_','_','_','_',#,'_','_','_','_',#,'_','_','_','_'],['_','_','_','_','_',#,'_','_','_','_',#,'_','_','_','_'],['_','_','_','_','_',#,'_','_','_','_',#,'_','_','_','_'],['_','_','_','_',#,'_','_','_',#,'_','_','_','_','_','_'],[#,#,#,'_','_','_','_',#,'_','_','_',#,'_','_','_'],['_','_','_','_','_','_',#,'_','_','_','_',#,#,#,#],['_','_','_','_','_',#,'_','_','_','_','_',#,'_','_','_'],['_','_','_','_',#,'_','_','_','_','_',#,'_','_','_','_'],['_','_','_',#,'_','_','_','_','_',#,'_','_','_','_','_'],[#,#,#,#,'_','_','_','_',#,'_','_','_','_','_','_'],['_','_','_',#,'_','_','_',#,'_','_','_','_',#,#,#],['_','_','_','_','_','_',#,'_','_','_',#,'_','_','_','_'],['_','_','_','_',#,'_','_','_','_',#,'_','_','_','_','_'],['_','_','_','_',#,'_','_','_','_',#,'_','_','_','_','_'],['_','_','_','_',#,'_','_','_','_',#,'_','_','_','_','_']]
% puzzle data
% [[8,3,[[3,5],[4,8],[4,12],[6,12],[8,0],[10,0],[10,4],[11,7]]],[20,4,[[0,6],[0,11],[1,6],[1,11],[2,6],[2,11],[3,0],[4,3],[5,7],[7,0],[7,11],[9,4],[10,8],[11,11],[12,0],[12,5],[13,0],[13,5],[14,0],[14,5]]],[11,5,[[0,0],[1,0],[2,0],[6,0],[6,6],[7,5],[8,4],[8,10],[12,10],[13,10],[14,10]]],[4,6,[[3,9],[5,0],[9,9],[11,0]]]]
% [[8,3,[[4,0],[4,4],[5,3],[6,12],[8,0],[9,9],[10,8],[10,12]]],[18,4,[[0,0],[0,5],[1,0],[1,5],[2,0],[2,5],[3,11],[4,8],[7,0],[7,11],[10,3],[11,0],[12,6],[12,11],[13,6],[13,11],[14,6],[14,11]]],[11,5,[[0,10],[1,10],[2,10],[6,0],[6,6],[7,5],[8,4],[8,10],[12,0],[13,0],[14,0]]],[4,8,[[3,0],[5,7],[9,0],[11,7]]]]
%words1
% [[4,6,[['E','X','H','O','R','T'],['I','N','T','U','I','T'],['Q','U','I','R','K','Y'],['T','E','U','T','O','N']]],[4,8,[['C','R','I','T','I','C','A','L'],['E','D','G','I','N','E','S','S'],['K','N','I','T','T','I','N','G'],['N','O','I','S','E','T','T','E']]],[16,3,[['A','T','E'],['B','O','X'],['C','U','R'],['D','O','G'],['E','N','D'],['K','I','D'],['M','E','S'],['N','A','N'],['O','N','E'],['P','A','N'],['P','E','T'],['Q','E','D'],['R','I','O'],['R','O','Y'],['S','O','S'],['S','O','T']]],[22,5,[['A','N','O','D','E'],['A','U','N','T','Y'],['A','V','A','S','T'],['C','R','E','N','A'],['D','E','L','E','S'],['E','R','S','E','S'],['G','E','N','I','E'],['G','H','A','N','A'],['I','L','E','U','M'],['I','V','O','R','Y'],['K','N','O','T','S'],['L','I','P','I','D'],['O','A','S','I','S'],['O','R','A','T','E'],['O','R','I','O','N'],['O','X','I','D','E'],['S','C','O','N','E'],['S','C','O','T','S'],['S','L','E','P','T'],['S','N','O','R','E'],['V','E','R','N','E'],['V','I','N','E','S']]],[38,4,[['A','L','E','C'],['B','O','E','R'],['B','R','I','E'],['C','O','I','R'],['E','D','N','A'],['E','R','A','S'],['E','R','I','E'],['E','R','N','E'],['E','U','R','O'],['F','A','R','T'],['F','I','G','S'],['G','O','E','S'],['I','N','S','T'],['I','R','A','N'],['I','R','E','S'],['K','A','L','E'],['L','I','A','R'],['N','E','S','T'],['N','I','L','E'],['N','O','S','E'],['O','I','N','K'],['O','R','A','L'],['R','E','N','O'],['R','I','P','E'],['R','O','A','D'],['R','O','O','T'],['S','E','A','L'],['S','N','I','P'],['S','O','N','G'],['S','T','A','R'],['T','A','B','S'],['T','E','E','S'],['T','E','S','T'],['T','I','D','Y'],['U','N','I','T'],['V','E','R','T'],['V','O','L','T'],['X','R','A','Y']]]]

process_puzzle([['_','_','_','_','_',#,'_','_','_','_',#,'_','_','_','_'],['_','_','_','_','_',#,'_','_','_','_',#,'_','_','_','_'],['_','_','_','_','_',#,'_','_','_','_',#,'_','_','_','_'],['_','_','_','_',#,'_','_','_',#,'_','_','_','_','_','_'],[#,#,#,'_','_','_','_',#,'_','_','_',#,'_','_','_'],['_','_','_','_','_','_',#,'_','_','_','_',#,#,#,#],['_','_','_','_','_',#,'_','_','_','_','_',#,'_','_','_'],['_','_','_','_',#,'_','_','_','_','_',#,'_','_','_','_'],['_','_','_',#,'_','_','_','_','_',#,'_','_','_','_','_'],[#,#,#,#,'_','_','_','_',#,'_','_','_','_','_','_'],['_','_','_',#,'_','_','_',#,'_','_','_','_',#,#,#],['_','_','_','_','_','_',#,'_','_','_',#,'_','_','_','_'],['_','_','_','_',#,'_','_','_','_',#,'_','_','_','_','_'],['_','_','_','_',#,'_','_','_','_',#,'_','_','_','_','_'],['_','_','_','_',#,'_','_','_','_',#,'_','_','_','_','_']],
    [[8,3,[[3,5],[4,8],[4,12],[6,12],[8,0],[10,0],[10,4],[11,7]]],[20,4,[[0,6],[0,11],[1,6],[1,11],[2,6],[2,11],[3,0],[4,3],[5,7],[7,0],[7,11],[9,4],[10,8],[11,11],[12,0],[12,5],[13,0],[13,5],[14,0],[14,5]]],[11,5,[[0,0],[1,0],[2,0],[6,0],[6,6],[7,5],[8,4],[8,10],[12,10],[13,10],[14,10]]],[4,6,[[3,9],[5,0],[9,9],[11,0]]]],
[[8,3,[[4,0],[4,4],[5,3],[6,12],[8,0],[9,9],[10,8],[10,12]]],[18,4,[[0,0],[0,5],[1,0],[1,5],[2,0],[2,5],[3,11],[4,8],[7,0],[7,11],[10,3],[11,0],[12,6],[12,11],[13,6],[13,11],[14,6],[14,11]]],[11,5,[[0,10],[1,10],[2,10],[6,0],[6,6],[7,5],[8,4],[8,10],[12,0],[13,0],[14,0]]],[4,8,[[3,0],[5,7],[9,0],[11,7]]]],
[[4,6,[['E','X','H','O','R','T'],['I','N','T','U','I','T'],['Q','U','I','R','K','Y'],['T','E','U','T','O','N']]],[4,8,[['C','R','I','T','I','C','A','L'],['E','D','G','I','N','E','S','S'],['K','N','I','T','T','I','N','G'],['N','O','I','S','E','T','T','E']]],[16,3,[['A','T','E'],['B','O','X'],['C','U','R'],['D','O','G'],['E','N','D'],['K','I','D'],['M','E','S'],['N','A','N'],['O','N','E'],['P','A','N'],['P','E','T'],['Q','E','D'],['R','I','O'],['R','O','Y'],['S','O','S'],['S','O','T']]],[22,5,[['A','N','O','D','E'],['A','U','N','T','Y'],['A','V','A','S','T'],['C','R','E','N','A'],['D','E','L','E','S'],['E','R','S','E','S'],['G','E','N','I','E'],['G','H','A','N','A'],['I','L','E','U','M'],['I','V','O','R','Y'],['K','N','O','T','S'],['L','I','P','I','D'],['O','A','S','I','S'],['O','R','A','T','E'],['O','R','I','O','N'],['O','X','I','D','E'],['S','C','O','N','E'],['S','C','O','T','S'],['S','L','E','P','T'],['S','N','O','R','E'],['V','E','R','N','E'],['V','I','N','E','S']]],[38,4,[['A','L','E','C'],['B','O','E','R'],['B','R','I','E'],['C','O','I','R'],['E','D','N','A'],['E','R','A','S'],['E','R','I','E'],['E','R','N','E'],['E','U','R','O'],['F','A','R','T'],['F','I','G','S'],['G','O','E','S'],['I','N','S','T'],['I','R','A','N'],['I','R','E','S'],['K','A','L','E'],['L','I','A','R'],['N','E','S','T'],['N','I','L','E'],['N','O','S','E'],['O','I','N','K'],['O','R','A','L'],['R','E','N','O'],['R','I','P','E'],['R','O','A','D'],['R','O','O','T'],['S','E','A','L'],['S','N','I','P'],['S','O','N','G'],['S','T','A','R'],['T','A','B','S'],['T','E','E','S'],['T','E','S','T'],['T','I','D','Y'],['U','N','I','T'],['V','E','R','T'],['V','O','L','T'],['X','R','A','Y']]]]
,X).

read_file("./samples/puzzle2",A), ensure_loaded(library(clpfd)), clpfd:transpose(A,X),  process_empty_puzzle(X,Y), print(Y).

process_puzzle([['_','_','_','_'],['_','_','_',#],['_','_','_','_']],
    [[1,3,[[1,0]]],[2,4,[[0,0],[2,0]]]],
[[2,1,[[3,0],[3,2]]],[3,3,[[0,0],[1,0],[2,0]]]],
[[2,4,[[b,o,a,t],[n,e,e,d]]],[4,3,[[a,r,t],[a,t,e],[b,a,n],[o,r,e]]]], X).